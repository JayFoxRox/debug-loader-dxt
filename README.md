Unfinished; see notes in main.c
